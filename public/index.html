<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Gemini 3 Image Composer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    font-family: Arial, sans-serif;
    background: #eef1f5;
    padding: 30px;
}
.container {
    max-width: 1200px;
    margin: auto;
    background: white;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.1);
}
.upload-box {
    padding: 20px;
    border: 2px dashed #4a90e2;
    text-align: center;
    cursor: pointer;
    border-radius: 10px;
    margin-bottom: 20px;
}
.preview {
    max-height: 220px;
    display: none;
    border-radius: 10px;
    margin-top: 10px;
}
textarea {
    width: 100%;
    padding: 15px;
    border-radius: 10px;
    border: 2px solid #ddd;
}
select, button {
    width: 100%;
    padding: 15px;
    margin-top: 15px;
    border-radius: 10px;
    border: none;
}
button {
    background: #4a90e2;
    color: white;
    font-size: 18px;
    cursor: pointer;
}
button:hover {
    transform: scale(1.02);
}
.result-image {
    max-width: 100%;
    display: none;
    border-radius: 12px;
    margin-top: 20px;
}
</style>
</head>

<body>

<div class="container">
    <h1>üé® Gemini 3 Pro ‚Äî Image Composer</h1>
    <p>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –∫–æ–º–ø–æ–∑–∏—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π <b>gemini-3-pro-preview</b></p>

    <h3>üñº –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h3>

    <div class="upload-box" onclick="objectInput.click()">
        <p>üì∑ –ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å –æ–±—ä–µ–∫—Ç</p>
        <img id="objectPreview" class="preview">
    </div>
    <input type="file" id="objectInput" accept="image/*" style="display:none" onchange="preview(event,'objectPreview')">

    <div class="upload-box" onclick="backgroundInput.click()">
        <p>üèû –ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ–Ω</p>
        <img id="backgroundPreview" class="preview">
    </div>
    <input type="file" id="backgroundInput" accept="image/*" style="display:none" onchange="preview(event,'backgroundPreview')">

    <h3>‚úèÔ∏è –ü—Ä–æ–º—Ç</h3>
    <textarea id="prompt" placeholder="–û–ø–∏—à–∏—Ç–µ –∫–∞–∫ –Ω—É–∂–Ω–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –æ–±—ä–µ–∫—Ç –≤ —Ñ–æ–Ω..."></textarea>

    <h3>‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
    <label>Thinking Level</label>
    <select id="thinkingLevel">
        <option value="HIGH">HIGH</option>
        <option value="MEDIUM">MEDIUM</option>
        <option value="LOW">LOW</option>
    </select>

    <label>Media Resolution</label>
    <select id="mediaResolution">
        <option value="MEDIA_RESOLUTION_HIGH">HIGH</option>
        <option value="MEDIA_RESOLUTION_MEDIUM">MEDIUM</option>
        <option value="MEDIA_RESOLUTION_LOW">LOW</option>
    </select>

    <label>Output Quality</label>
    <select id="quality">
        <option value="1k">1K</option>
        <option value="2k" selected>2K</option>
        <option value="4k">4K</option>
    </select>

    <button onclick="generate()">üöÄ –°–æ–∑–¥–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</button>

    <img id="resultImage" class="result-image">
    <a id="downloadBtn" style="display:none" class="download-btn" download>üíæ –°–∫–∞—á–∞—Ç—å</a>
</div>

<script>
function preview(event, id) {
    const img = document.getElementById(id);
    img.src = URL.createObjectURL(event.target.files[0]);
    img.style.display = "block";
}

async function generate() {
    const objectFile = objectInput.files[0];
    const backgroundFile = backgroundInput.files[0];

    if (!objectFile || !backgroundFile) {
        alert("–ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è!");
        return;
    }

    const fd = new FormData();
    fd.append("objectImage", objectFile);
    fd.append("backgroundImage", backgroundFile);
    fd.append("prompt", document.getElementById("prompt").value);
    fd.append("thinkingLevel", document.getElementById("thinkingLevel").value);
    fd.append("mediaResolution", document.getElementById("mediaResolution").value);
    fd.append("quality", document.getElementById("quality").value);

    const result = await fetch("/generate", { method: "POST", body: fd });
    const data = await result.json();

    if (!data.success) {
        alert("–û—à–∏–±–∫–∞: " + data.error);
        return;
    }

    resultImage.src = data.imageUrl;
    resultImage.style.display = "block";

    downloadBtn.href = data.imageUrl;
    downloadBtn.download = data.filename;
    downloadBtn.style.display = "inline-block";
}
</script>

</body>
</html>
